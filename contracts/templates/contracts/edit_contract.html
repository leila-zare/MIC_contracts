{% load static %}
 

<!DOCTYPE html>
<html lang="fa" locale="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اصلاح قرارداد</title>
     {{ form.media }}      <!-- بارگذاری استایل ها و جاوا اسکریپت های تقویم شمسی -->
        <link rel="stylesheet" href="{% static '/contracts/jalali-input/jalalidatepicker.min.css' %}">

        <!-- jQuery Validation JS -->
        <script src="{% static '/contracts/js/jquery-3.6.0.min.js' %}"></script>
        <script src="{% static '/contracts/js/jquery.validate.min.js' %}"></script>

        <script src="{% static '/contracts/js/inputmask.min.js' %}"></script>

        <script src="{% static '/contracts/jalali-input/jalalidatepicker.min.js' %}"></script>
        <!-- <script>jalaliDatepicker.startWatch();</script> -->
        <script>
            document.addEventListener('DOMContentLoaded', function(){
                jalaliDatepicker.startWatch();
            });

            
        </script>

    <style>
        body {
            font-family: 'B Titr', sans-serif;
            /* font-size: large; */
            background-color: #f5f5f5;
            direction: ltr;
            text-align: left;
            margin: 0;
            padding: 0;
            direction: rtl;
            display: flex;
            justify-content: center;
        }
        button {
            font-family: 'B Titr', sans-serif;
            font-size: 1.5em;
            border-color: #ffffff;
            direction: ltr;
            margin: 5px;
            background-color: #006d5b;
            border-radius: 10px;
            padding: 5px 20px;
            color: #ffffff;
            /* border-width: 25px; */
            text-align: center;
            cursor: pointer;
        }
        button:hover{
            background-color: #025345;
        }
        .submit_button{
            display: flex;
            text-align: center;
            justify-content: center;
        }
                    

        .box {
            background-color: #006d5b;
            color: white;
            width: 235px;
            height: 50px;
            margin: 7px;
            display: flex;
            align-items: center; /* Align items vertically centered */
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s, background-color 0.3s;
            font-size: 18px;
            position: relative; /* For better hover effects */
            justify-content: flex-start; /* Align content to the start (left) */
            padding: 0px; /* Add padding */
        }
        .box:hover {
            transform: scale(1.05);
            background-color: #005b4f; /* Darker shade on hover */
        }
        .box img {            
            margin-left: 10px;
            width: 35px;
            height: 35px;
    
        }
        .box span {
            font-size: 15px;
            font-weight: bold;
            text-align: center ;
            margin-right: px; /* Space between icon and text */
        }
        /* Styles for specific rows */
        .row {
            display: flex;
            justify-content: left;
            width: 100%;
        }
        @media (max-width: 600px) {
            .box {
                width: 90%; /* Full width on small screens */
                height: 40px; /* Slightly shorter */
            }
        }
        /* استایل کلی برای نمایش هر دو بخش کنار هم */
        .main-container {
            display: flex;
            gap: 20px;
            width: 90%;
            margin: 20px auto;
        }   
        /* استایل قسمت ساید بار */
        .card {width: 250px;
            text-align: center;
            /* border: 2px solid #006d5b; */
            border-radius: 10px;
            padding: 10px;
            /* background-color: #fff; */
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        }        
        .card img {
            width: 250px;
            height: 250px;
            border-radius: 50%;
            /* margin-bottom: 15px; */
        }
        .card .box img {
            margin-left: 10px;
            width: 35px;
            height: 35px;
            text-align: center;
        }
        .name-box, .title-box {
            background-color: #ffffff;
            border-radius: 15px;
            /* border: #006d5b; */
            /* padding: 0.01%; */
            color: #006d5b;
            text-align: center;
            margin-bottom: 5px;
            /* border: #006d5b; */
            border-width: 10px;
        }
        h2{
            font-size: medium;
        }



        /* استایل مربوط به آیکون های سمت راست */
        .box {
            background-color: #006d5b;
            color: white;
            width: 235px;
            height: 50px;
            margin: 7px;
            display: flex;
            align-items: center; /* Align items vertically centered */
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s, background-color 0.3s;
            font-size: 18px;
            position: relative; /* For better hover effects */
            justify-content: flex-start; /* Align content to the start (left) */
            padding: 0px; /* Add padding */
        }        
        .box:hover {
            transform: scale(1.05);
            background-color: #005b4f; /* Darker shade on hover */
        }        
        .box img {            
            margin-left: 10px;
            width: 35px;
            height: 35px;
    
        }
        .box span {
            font-size: 15px;
            font-weight: bold;
            text-align: center ;
            margin-right: px; /* Space between icon and text */
        }
       /* /////////////////////////////////////////////////////////////////////////////////  */
        /* استایل‌های اطلاعات هویتی و قراردادها */
        .details-container {
            flex: 1;
        }
        .container {
            background-color: #f5f6ed;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 2px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
            text-align: center;
            display: flex;
        }
        h1 {
            background-color: #8eb10e;
            color: #fff;
            padding: 5px;
            border-radius: 10px;
            font-size: 1.5em;
            /* size: small; */
            width: 50vh;
            /* height: 35px; */
            display:flex;
            justify-content: center;
            align-items: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            border-radius: 20px;
            padding: auto;
        }
        th, td {
            padding: 10px;
            text-align: center;
            border: 1px solid #ffffff;
            border-radius: 10px;
        }
        th {
            background-color: #eeefed;
            color:#014b41;
            font-weight: bold;
        }
        td {
            /* background-color: #f7f1f1; */
            border: 1px solid #ffffff;
        }
        input[type="text"], input[type="number"], input[type="date"], input[type="email"] {
            width: 100%;
            font-family: 'B Titr', sans-serif;
            border-radius: 10px;
            background-color: #f1eded;
            border: 1px solid #ccc;
            /* padding: 10px; */
            /* color:#006d5b; */
            text-align: center;
        }
        ul {
            color: red;
            font-size: 10px;
            margin: 5px 0;
            padding: 0;
        }
        .errorlist{
            color: red;
        }
        li {
            list-style: none;
        }

        .error {
            color: red;
            font-size: 10px;
            display: none; /* پیش‌فرض پیام‌ها مخفی */
        }
        .select_form{
            background-color: #ffffff;
            /* padding: 10px; */
            text-align: center;
            border: 1px solid #ccc;
            font-family: "B Titr";
            width: 100%;
            font-family: 'B Titr', sans-serif;
            border-radius: 10px;
            background-color: #f1eded;
            border: 1px solid #ccc;
        }


    </style>
</head>
<body>
    <div class="main-container">
        <!-- {% if messages %}
        {% for message in messages %}
        <p style="color: green; font-family: B Nazanin; font-size: small;">{{ message }}</p>
        {% endfor %}
        {% endif %} -->
        <!-- کارت کاربری در سمت چپ -->
        <div class="sidebar_card">
            <div class="card">
                <img src="{% static 'contracts/image/image.PNG' %}" alt="تصویر لیلا زارع">
                <div class="name-box">
                    <h2>لیلا زارع</h2>
                </div>
                <div class="title-box">
                    <p>کارشناس منابع انسانی و نرم‌افزار</p>
                </div>
                <div class="colomn">
                    <div class="box" aria-label="آیین نامه‌ها و فرآیندها">
                        <img src="{% static 'contracts/icons/processes.png' %}" alt="Process icon">
                        <span>آیین نامه‌ها و فرآیندها</span>
                    </div>

                    <div class="box" aria-label="روابط عمومی">
                        <img src="{% static 'contracts/icons/public_relations.png' %}" alt="Public relations icon">
                        <span>روابط عمومی</span>
                    </div>

                    <div class="box" aria-label="پرسنلی">
                        <img src="{% static 'contracts/icons/personnel.png' %}" alt="Personnel icon">
                        <span>پرسنلی</span>
                    </div>

                    <div class="box" style="transform: scale(1.05); background-color: #005b4f;"aria-label="قراردادها">
                        <img src="{% static 'contracts/icons/contracts.png' %}" alt="Contracts icon">
                        <span>قراردادها</span>
                    </div>

                    <div class="box" aria-label="بودجه و اعتبار">
                        <img src="{% static 'contracts/icons/budget.png' %}" alt="Budget icon">
                        <span>بودجه و اعتبار</span>
                    </div>

                    <div class="box" aria-label="بازرگانی">
                        <img src="{% static 'contracts/icons/commerce.png' %}" alt="Commerce icon">
                        <span>بازرگانی</span>
                    </div>

                    <div class="box" aria-label="داشبورد مدیریت">
                        <img src="{% static 'contracts/icons/dashboard.png' %}" alt="Dashboard icon">
                        <span>داشبورد مدیریت</span>
                    </div>

                    <div class="box" aria-label="کنترل محصول و انبار">
                        <img src="{% static 'contracts/icons/inventory.png' %}" alt="Inventory icon">
                        <span>کنترل محصول و انبار</span>
                    </div>

                    <div class="box" aria-label="دبیرخانه">
                        <img src="{% static 'contracts/icons/secretariat.png' %}" alt="Secretariat icon">
                        <span>دبیرخانه</span>
                    </div>

                </div>
            </div>
        </div>       
        <!-- اطلاعات مربوط به قرارداد در سمت راست -->
        <div class="details-container">
            <form id="myform" action="" method="post" onsubmit="return handleSubmit();">
                {% csrf_token %}
                
                <!-- اطلاعات هویتی -->
                <div class="container">
                    <h1>اطلاعات هویتی</h1>

                    <input type="text" style="display: none;" class="date vjDateField" name="date_of_birth" id="date_of_birth">
                    <input type="text" style="display: none;" class="date vjDateField" name="contract_start_date" id="contract_start_date">
                    <input type="text" style="display: none;" class="date vjDateField" name="contract_end_date" id="contract_end_date">


                    <table>
                        <tr>
                            <th><label for="full_name">نام و نام خانوادگی</label></th>
                            <th><label for="national_id">کد ملی</label></th>
                            <th><label for="ID_number">شماره شناسنامه</label></th>
                            <th><label for="date_of_birth_txt">تاریخ تولد</label></th>
                            <th><label for="place_of_issue">محل صدور</label></th>
                            <th><label for="fathers_name">نام پدر</label></th>
                            <th><label for="marital_status">وضعیت تاهل</label></th>
                            <th><label for="child_number">تعداد فرزند</label></th>
                        </tr>
                        <tr>
                            <td><input type="text" class="text" name="full_name" id="full_name" value="{{contract.full_name}}">
                                <div class="error" data-for="text"> وارد نام و نام خانوادگی اجباری است</div></td>                            
                            <td><input type="text" class="text" name="national_id" id="national_id" value="{{contract.national_id}}">
                                <div class="error" data-for="text"> وارد کردن کد ملی اجباری است</div></td>
                            <td><input type="text" class="text" name="ID_number" id="ID_number" value="{{contract.ID_number}}">
                                <div class="error" data-for="text"> وارد کردن شماره شناسنامه اجباری است</div></td>
                            <td><input type="text" onchange="setBirthDate(this)" data-jdp-min-date="today" data-jdp style="z-index: 99999;" class="date" name="date_of_birth_txt" id="date_of_birth_txt" placeholder="yyyy/mm/dd" value="{{contract.date_of_birth}}">
                                <div class="error" data-for="date"> وارد کردن تاریخ اجباری است</div></td>
                            <td><input type="text" class="text" name="place_of_issue" id="place_of_issue"value="{{contract.place_of_issue}}">
                                <div class="error" data-for="text"> وارد کردن محل صدور اجباری است</div></td>
                            <td><input type="text" class="text" name="fathers_name" id="fathers_name"value="{{contract.fathers_name}}">
                                <div class="error" data-for="text"> وارد کردن نام پدر اجباری است</div></td>
                            <td><select class='select_form' name="marital_status" id="marital_status">
                                <option value="متأهل" {% if contract.marital_status == "متأهل" %}selected{% endif %}>متأهل</option>
                                <option value="مجرد" {% if contract.marital_status == "مجرد" %}selected{% endif %}>مجرد</option>
                            </select>
                            </td>
                            <td><input type="number" class="number_input" name="child_number" id="child_number" value="{{contract.child_number}}">
                                <div class="error" data-for="number_input"> وارد کردن تعداد فرزندان اجباری است</div></td> 
                        </tr>
                        <tr>
                            <th><label for="contact_number">شماره تماس</label></th>
                            <th><label for="email">آدرس ایمیل</label></th>
                            <th><label for="postal_code">کد پستی </label></th>
                            <th><label for="address"> آدرس</label></th>
                            <th><label for="military_status">نظام وظیفه</label></th>
                            <th><label for="degree_of_study">مدرک تحصیلی</label></th>
                            <th><label for="field_of_study">رشته تحصیلی</label></th>
                            <th><label for="reference">معرف</label></th>
                        </tr>
                        <tr>
                            <td><input type="text" class="text" name="contact_number" id="contact_number" value="{{contract.contact_number}}">
                                <div class="error" data-for="text"> وارد کردن شماره تماس اجباری است</div></td>
                            <td><input type="email" name="email" id="email" value="{{contract.email}}">
                                <div class="error" data-for="email"> لطفا یک ایمیل معتبر وارد کنید</div></td>
                            <td><input type="text" class="text" name="postal_code" id="postal_code" value="{{contract.postal_code}}">
                                <div class="error" data-for="text"> وارد کردن کد پستی اجباری است</div></td>
                            <td><input type="text" class="text" name="address" id="address" value="{{contract.address}}">
                                <div class="error" data-for="text"> وارد کردن آدرس اجباری است</div></td>
                            <td><select class='select_form' name="military_status" id="military_status">
                                <option value="نیاز به خدمت ندارد" {% if contract.military_status == "نیاز به خدمت ندارد" %}selected{% endif %}>نیاز به خدمت ندارد</option>
                                <option value="معاف شده" {% if contract.military_status == "معاف شده" %}selected{% endif %}>معاف شده</option>
                                <option value="در حال خدمت" {% if contract.military_status == "در حال خدمت" %}selected{% endif %}>در حال خدمت</option>
                                <option value="پایان خدمت" {% if contract.military_status == "پایان خدمت" %}selected{% endif %}>پایان خدمت</option>
                                <option value="معافیت تحصیلی" {% if contract.military_status == "معافیت تحصیلی" %}selected{% endif %}>معافیت تحصیلی</option>
                            </select>
                            </td>
                            <td><select class='select_form' name="degree_of_study" id="degree_of_study">
                                <option value="سیکل" {% if contract.degree_of_study == "سیکل" %}selected{% endif %}>سیکل</option>
                                <option value="دیپلم" {% if contract.degree_of_study == "دیپلم" %}selected{% endif %}>دیپلم</option>
                                <option value="فوق دیپلم" {% if contract.degree_of_study == "فوق دیپلم" %}selected{% endif %}>فوق دیپلم</option>
                                <option value="کارشناسی" {% if contract.degree_of_study == "کارشناسی" %}selected{% endif %}>کارشناسی</option>
                                <option value="کارشناسی ارشد" {% if contract.degree_of_study == "کارشناسی ارشد" %}selected{% endif %}>کارشناسی ارشد</option>
                                <option value="دکتری" {% if contract.degree_of_study == "دکتری" %}selected{% endif %}>دکتری</option>
                                <option value="فوق دکتری" {% if contract.degree_of_study == "فوق دکتری" %}selected{% endif %}>فوق دکتری</option>
                                <option value="حوزوی" {% if contract.degree_of_study == "حوزوی" %}selected{% endif %}>حوزوی</option>
                            </select>
                            </td>
                            <td><input type="text" class="text" name="field_of_study" id="field_of_study" value="{{contract.field_of_study}}">
                                <div class="error" data-for="text"> وارد کردن رشته تحصیلی اجباری است</div></td>
                            <td><input type="text" class="text" name="reference" id="reference" value="{{contract.reference}}">
                                <div class="error" data-for="text"> وارد کردن معرف اجباری است</div></td>
                        </tr>
                    </table>

                </div>

                <!-- اطلاعات قرارداد -->
                <div class="container">

                    <h1>اطلاعات قرارداد</h1>
                    <table>
                        <tr>
                            <th><label for="contract_type">نوع قرارداد</label></th>
                            <th><label for="contract_number">شماره قرارداد</label></th>
                            <th><label for="contract_start_date_txt">تاریخ شروع</label></th>
                            <th><label for="contract_end_date_txt">تاریخ پایان</label></th>
                            <th><label for="job_group">گروه کاری</label></th>
                            <th><label for="job_position">سمت شغلی</label></th>
                            <th><label for="insurance_type">نوع بیمه</label></th>
                            <th><label for="declared_salary">حقوق ابرازی</label></th>
                        </tr>
                        <tr>
                            <td><select class='select_form' name="contract_type" id="contract_type">
                                <option value="معین" {% if contract.contract_type == "معین" %}selected{% endif %}>معین</option>
                                <option value="شبه معین" {% if contract.contract_type == "شبه معین" %}selected{% endif %}>شبه معین</option>
                                <option value="ساعتی" {% if contract.contract_type == "ساعتی" %}selected{% endif %}>ساعتی</option>
                            </select>
                            <td><input type="text" class="text" name="contract_number" id="contract_number" value="{{contract.contract_number}}">
                                <div class="error" data-for="text"> وارد کردن شماره قرارداد اجباری است</div></td>
                            <td><input type="text" onchange="setStartDate(this)" data-jdp-min-date="today" data-jdp style="z-index: 99999;" class="date" name="contract_start_date_txt" id="contract_start_date_txt" placeholder="yyyy/mm/dd" value="{{contract.contract_start_date}}">
                                <div class="error" data-for="date"> وارد کردن تاریخ اجباری است</div></td>
                            <td><input type="text" onchange="setEndDate(this)" data-jdp-min-date="today" data-jdp style="z-index: 99999;" class="date" name="contract_end_date_txt" id="contract_end_date_txt" placeholder="yyyy/mm/dd" value="{{contract.contract_end_date}}">
                                <div class="error" data-for="date"> وارد کردن تاریخ اجباری است</div></td>   
                            <td><select class='select_form' name="job_group" id="job_group">
                                <option value="ستاد" {% if contract.job_group == "ستاد" %}selected{% endif %}>ستاد</option>
                                <option value="مدیریت" {% if contract.job_group == "مدیریت" %}selected{% endif %}>مدیریت</option>
                                <option value="فنی" {% if contract.job_group == "فنی" %}selected{% endif %}>فنی</option>
                                <option value="بازرگانی" {% if contract.job_group == "بازرگانی" %}selected{% endif %}>بازرگانی</option>
                                <option value="دفتر قم" {% if contract.job_group == "دفتر قم" %}selected{% endif %}>دفتر قم</option>
                            </select>
                            <td><input type="text" class="text" name="job_position" id="job_position" value="{{contract.job_position}}">
                                <div class="error" data-for="text"> وارد کردن گروه کاری اجباری است</div></td>
                            <td><select class='select_form' name="insurance_type" id="insurance_type">
                                <option value="کارفرما" {% if contract.insurance_type == "کارفرما" %}selected{% endif %}>کارفرما</option>
                                <option value="کارمند" {% if contract.insurance_type == "کارمند" %}selected{% endif %}>کارمند</option>
                            </select>
                            <td><select class='select_form' name="declared_salary" id="declared_salary">
                                <option value="پایه" {% if contract.declared_salary == "پایه" %}selected{% endif %}>پایه</option>
                                <option value="واقعی" {% if contract.declared_salary == "واقعی" %}selected{% endif %}>واقعی</option>
                            </select>
                        </tr>
                        <tbody><tr>
                            <th><label for="base_salary">حق پایه</label></th>
                            <th><label for="housing_allowance">حق مسکن</label></th>
                            <th><label for="food_allowance">حق خوار و بار</label></th>
                            <th><label for="seniority_pay">پایه سنوات ماهانه</label></th>
                            <th><label for="child_allowance">حق اولاد</label></th>
                            <th><label for="marriage_allowance">حق تاهل</label></th>
                            <th><label for="transportation_allowance">ایاب و دهاب</label></th>
                            <th><label for="attraction_bonus">فوق العاده جذب</label></th>
                        </tr>
                        <tbody><tr>
                            <td><input type="text" inputmode="numeric" class="number_input" name="base_salary" id="base_salary" value="{{contract.base_salary}}">
                                <div class="error" data-for="number_input"> وارد کردن حق پایه اجباری است</div></td>                
                            <td><input type="text" inputmode="numeric" class="number_input" name="housing_allowance" id="housing_allowance" value="{{contract.housing_allowance}}">
                                <div class="error" data-for="number_input"> وارد کردن حق مسکن اجباری است</div></td>                
                            <td><input type="text" inputmode="numeric" class="number_input" name="food_allowance" id="food_allowance" value="{{contract.food_allowance}}">
                                <div class="error" data-for="number_input"> وارد کردن حق خوار و بار اجباری است</div></td>                
                            <td><input type="text" inputmode="numeric" class="number_input" name="seniority_pay" id="seniority_pay" value="{{contract.seniority_pay}}">
                                <div class="error" data-for="number_input"> وارد کردن پایه سنوات ماهانه اجباری است</div></td>                
                            <td><input type="text" inputmode="numeric" class="number_input" name="child_allowance" id="child_allowance" value="{{contract.child_allowance}}" readonly>
                                <div class="error" data-for="number_input"> وارد کردن حق اولاد اجباری است</div></td>                
                            <td><input type="text" inputmode="numeric" class="number_input" name="marriage_allowance" id="marriage_allowance" value="{{contract.marriage_allowance}}" readonly>
                                <div class="error" data-for="number_input"> وارد کردن حق تاهل اجباری است</div></td>                
                            <td><input type="text" inputmode="numeric" class="number_input" name="transportation_allowance" id="transportation_allowance" value="{{contract.transportation_allowance}}">
                                <div class="error" data-for="number_input"> وارد کردن ایاب و ذهاب اجباری است</div></td>               
                            <td><input type="text" inputmode="numeric" class="number_input" name="attraction_bonus" id="attraction_bonus" value="{{contract.attraction_bonus}}"readonly>
                                <div class="error" data-for="number_input"> وارد کردن فوق العاده جذب اجباری است</div></td>
                        </tr>
                         <tr>
                            <th><label for="management_allowance">حق مدیریت</label></th>
                            <th><label for="hourly_wage">دستمزد ساعتی</label></th>
                            <th><label for="hourly_wage_with_accord">درصد آکورد</label></th>
                            <th><label for="insurance_number">شماره بیمه</label></th>
                        </tr>
                        <tr>
                            <td><input type="text" inputmode="numeric" class="number_input" name="management_allowance" id="management_allowance" value="{{contract.management_allowance}}">
                                <div class="error" data-for="number_input"> وارد کردن حق مدیریت اجباری است</div></td>               
                            <td><input type="text" inputmode="numeric" class="number_input" name="hourly_wage" id="hourly_wage" value="{{contract.hourly_wage}}">
                                <div class="error" data-for="number_input"> وارد کردن دستمزد ساعتی اجباری است</div></td>                
                            <td><input type="number" class="number_input" name="hourly_wage_with_accord" id="hourly_wage_with_accord" value="{{contract.hourly_wage_with_accord}}" min="0" max="100">
                                <div class="error" data-for="number_input"> وارد کردن درصد آکورد اجباری است</div></td>                
                            <td><input type="text" inputmode="numeric" class="text" name="insurance_number" id="insurance_number"value="{{contract.insurance_number}}">
                                <div class="error" data-for="text"> وارد کردن شماره بیمه اجباری است</div></td>
                        </tr>
                    </table>
                </div>
                <!-- اطلاعات حساب بانکی مرتبط با شرکت -->
                <div class="container">
                    <h1>اطلاعات حساب بانکی</h1>
                    <table>
                        <tbody><tr>
                            <th><label for="bank_name_salary">نام بانک</label></th>
                            <th><label for="account_number_salary">شماره حساب</label></th>
                            <th><label for="IBAN_salary">شماره شبا</label></th>
                        </tr>
                        <tbody><tr>
                            <td><input type="text" class="text" name="bank_name_salary" id="bank_name_salary" value="{{contract.bank_name_salary}}">
                                <div class="error" data-for="text"> وارد کردن نام بانک اجباری است</div></td> 
                            <td><input type="text" class="text" name="account_number_salary" id="account_number_salary" value="{{contract.account_number_salary}}">
                                <div class="error" data-for="text"> وارد کردن شماره حساب اجباری است</div></td>               
                            <td><input type="text" class="text" name="IBAN_salary" id="IBAN_salary" value="{{contract.IBAN_salary}}">
                                <div class="error" data-for="text"> وارد کردن شماره شبا اجباری است</div></td>  
                        </tr>
                    </tbody></table>
                </div>
                <div class="submit_button">
                    <button type="submit" onclick="confirmSubmission()"> ثبت </button>
                    <!-- برای این قسمت حتما باید عملکردشو اضافه کنم -->
                     <a href="{% url 'contracts:contractlist' %}" onclick="return showAlert();">
                        <button type="button" > لغو </button>
                    </a>
                </div>
            </form>
          
        </div>
    </div>
    <script>
            // انتخاب تمام فیلدهای ورودی عددی
        const numberInputs = document.querySelectorAll('.number_input');

        // اضافه کردن Event Listener برای هر فیلد
        numberInputs.forEach(input => {
        input.addEventListener('input', function (event) {
            let value = event.target.value;

            // حذف کاماها و کاراکترهای غیرعددی
            value = value.replace(/,/g, '').replace(/\D/g, '');

            // فرمت کردن عدد به صورت سه رقم جدا
            const formattedValue = new Intl.NumberFormat('en-US').format(value);

            // اعمال مقدار فرمت‌شده به فیلد
            event.target.value = formattedValue;
             });
        });

        // پاکسازی مقادیر قبل از ارسال فرم
        document.getElementById('myform').addEventListener('submit', function (event) {
        numberInputs.forEach(input => {
            input.value = input.value.replace(/,/g, ''); // حذف کاماها
            });
        });
        // تابع برای فرمت کردن فیلدهای عددی در بارگذاری صفحه  
        function formatNumberInputs() {  
            numberInputs.forEach(input => {  
                let value = input.value.replace(/,/g, '').replace(/\D/g, '');  
                if (value) {  
                    const formattedValue = new Intl.NumberFormat('en-US').format(value);  
                    input.value = formattedValue;  
                }  
            });  
        }  

        // وقتی صفحه بارگذاری شد، فیلدها فرمت می‌شوند  
        document.addEventListener('DOMContentLoaded', formatNumberInputs); 

        function setBirthDate(input) {
            document.getElementById('date_of_birth').value = input.value.replace(/\//g, '-');
        }
        function setStartDate(input) {
            document.getElementById('contract_start_date').value = input.value.replace(/\//g, '-');
        }
        function setEndDate(input) {
            document.getElementById('contract_end_date').value = input.value.replace(/\//g, '-');
        }
    </script>
    <!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <!-- // پر کردن فیلدهای مخفی مربوط به تاریخ برای اینکه فر ارسل گردد. -->
    <!-- این قسمت با قسمت صفحه ایجا قرارداد متفاوت است -->
    <script>  
        // هنگامی که صفحه بارگذاری می‌شود، فیلدهای مخفی را پر کنید  
        document.addEventListener('DOMContentLoaded', function() {  
            document.getElementById('date_of_birth_txt').value = '{{ contract.date_of_birth }}';  
            document.getElementById('contract_start_date_txt').value = '{{ contract.contract_start_date }}';  
            document.getElementById('contract_end_date_txt').value = '{{ contract.contract_end_date }}';  
            
            // رویداد تغییر روی datepickerها برای به‌روزرسانی فیلدهای مخفی  
            document.getElementById('date_of_birth_txt').addEventListener('change', function() {  
                document.getElementById('date_of_birth').value = this.value.replace(/\//g, '-');  
            });  
        
            document.getElementById('contract_start_date_txt').addEventListener('change', function() {  
                document.getElementById('contract_start_date').value = this.value.replace(/\//g, '-');  
            });  
        
            document.getElementById('contract_end_date_txt').addEventListener('change', function() {  
                document.getElementById('contract_end_date').value = this.value.replace(/\//g, '-');  
            });  
        
            // پر کردن فیلدهای مخفی به طور خودکار  
            document.getElementById('date_of_birth').value = '{{ contract.date_of_birth|date:"Y-m-d" }}'.replace(/\//g, '-');  
            document.getElementById('contract_start_date').value = '{{ contract.contract_start_date|date:"Y-m-d" }}'.replace(/\//g, '-');  
            document.getElementById('contract_end_date').value = '{{ contract.contract_end_date|date:"Y-m-d" }}'.replace(/\//g, '-');  
        });  
        </script>
    <!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    
    <!-- برای قسمت مربوط به درصد آکورد -->
    <script>
        document.getElementById('hourly_wage_with_accord').addEventListener('input', function(event){
            const value = parseInt(event.target.value,10);
            if (value < 0 || value > 100){
                alert('درصد باید بین 0 تا 100 باشد');
                event.target.value = '';

            }
        })
    </script>
    <script>
        document.getElementById('child_number').addEventListener('input', function(event){
            const value = parseInt(event.target.value,10);
            if (value < 0 || value > 6){
                alert('تعداد فرزندان باید عددی صحییح بین 0 تا 6 باشد');
                event.target.value = '';

            }
        })
    </script>
    <script>
    $(document).ready(function () {
        $("#myform").submit(function (e) {
            let isValid = true;

            // بررسی فیلدهای عددی
            $(".number_input").each(function () {
                
                let value = $(this).val().trim();
                const errorElement = $(this).next(".error[data-for='number_input']");
                let numericValue = value.replace(/,/g,'').replace(/\s/g, '');
                if (numericValue === "" || isNaN(numericValue)) {
                    isValid = false;
                    errorElement.show(); // نمایش پیام خطا
                } else {
                    errorElement.hide(); // پنهان کردن پیام خطا
                }
            });

            // بررسی فیلدهای متنی
            $(".text").each(function () {
                const value = $(this).val().trim();
                const errorElement = $(this).next(".error[data-for='text']");
                if (value === "") {
                    isValid = false;
                    errorElement.show();
                } else {
                    errorElement.hide();
                }
            });

            // بررسی فیلد ایمیل
            const email = $("#email").val().trim();
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            const emailErrorElement = $("#email").next(".error[data-for='email']");
            if (!emailRegex.test(email)) {
                isValid = false;
                emailErrorElement.show();
            } else {
                emailErrorElement.hide();
            }
            // بررسی فیلدهای تاریخ
            $(".date").each(function () {
                    const value = $(this).val().trim();
                    console.log(value);
                    console.log(typeof value);
                    const errorElement = $(this).next(".error[data-for='date']");
                    if (value === "") {
                        isValid = false;
                        errorElement.show();
                    } else {
                        errorElement.hide();
                    }
                });

                // جلوگیری از ارسال فرم در صورت وجود خطا
                if (!isValid) {
                    e.preventDefault();
                }
            });
        });
    </script>
        <!-- جهت اطمینان از ثبت تغییرات -->
    <script>  
        function confirmSubmission() {  
            const confirmation = confirm("آیا از ایجاد تغییرات مطمئن هستید؟");  
            if (confirmation) {  
                document.getElementById("myForm").submit(); // فرم را ارسال می‌کند  
            }  
        }  
    </script>
    
    
    <!-- محاسبه حق اولاد -->
    <script>
        document.addEventListener('DOMContentLoaded', function(){
            document.getElementById('child_number').addEventListener('input', function(){
            const childNumber = parseInt(this.value) || 0;
            const allowanceRate = 48484;
            const childAllowance = childNumber * allowanceRate;
            document.getElementById('child_allowance').value = formatNumber(childAllowance);
        });
        });
        function formatNumber(num){
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
    </script>
    <!-- محاسبه حق تاهل -->
    <script>
        document.getElementById('marital_status').addEventListener('change', function(){
            const marriageStatus = this.value;
            const allowanceAmount = '33,000';
            document.getElementById('marriage_allowance').value = (marriageStatus === 'متأهل' ) ? allowanceAmount : 0;
        });
    </script>
        
    <!-- محاسبه فیلد فوق العداه جذب از روی پارامترهای دیگر -->
    <script>
        function calculateExtraBonus() {
            function getnumericValue(inputID){
                let rawValue = document.getElementById(inputID).value;
                return parseInt(rawValue.replace(/,/g ,'')) || 0;
            }

            // پارامترهایی که در فرانت مقدار پیش فرض براشون در نظر گرفتیم
            let baseSalary = getnumericValue('base_salary');
            let housingAllowance = getnumericValue('housing_allowance');
            let foodAllowance = getnumericValue('food_allowance');
            let yearlyBonus = getnumericValue('seniority_pay');
            let transportation = getnumericValue('transportation_allowance');
            
            // پارامترهای حق تاهل و حق ولاد
            let childAllowance = getnumericValue('child_allowance');
            let maritalAllowance = getnumericValue('marriage_allowance');

            // پارامترهای دستمزد ساعتی و حق مدیریت
            let hourlyWage = getnumericValue('hourly_wage');
            let managementAllowance = getnumericValue('management_allowance');


            console.log(baseSalary, typeof baseSalary)
            console.log(housingAllowance, typeof housingAllowance)
            console.log(foodAllowance, typeof foodAllowance)
            console.log(yearlyBonus, typeof yearlyBonus)
            console.log(childAllowance, typeof childAllowance)
            console.log(maritalAllowance, typeof maritalAllowance)
            console.log(transportation, typeof transportation)
            console.log(managementAllowance, typeof managementAllowance)
            console.log(hourlyWage, typeof hourlyWage)

            // محاسبه‌ی مجموع بقیه‌ی فیلدها
            const totalSalary = baseSalary + housingAllowance + foodAllowance + yearlyBonus + 
                                childAllowance + maritalAllowance + transportation + managementAllowance;
    
            // محاسبه‌ی فوق‌العاده جذب
            const extraBonus =  hourlyWage - totalSalary ;
    
            // نمایش مقدار محاسبه‌شده در فیلد مربوطه
            document.getElementById('attraction_bonus').value = formatNumber(extraBonus);
        }
        function formatNumber(num){
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
    
        // اجرای تابع هنگام تغییر مقدار دستمزد ساعتی
        document.getElementById('hourly_wage').addEventListener('input', calculateExtraBonus);
        document.getElementById('management_allowance').addEventListener('input', calculateExtraBonus);
    </script>
    <!-- پیام تغییرات با موفقیت ثبت شد -->
    <script>  
        function handleSubmit() {  
            // فرض کنید که در اینجا کد مربوط به ثبت اطلاعات قراردادی شما وجود دارد  
            // و پس از موفقیت در ثبت داده‌ها، به این صورت عمل می‌کنیم:  
        
            const isSuccess = true; // فرض کنید که ثبت موفقیت‌آمیز باشد  
            if (isSuccess) {  
                sessionStorage.setItem('updateSuccess', 'true'); // ذخیره وضعیت در sessionStorage  
                window.location.href = '{% url "contracts:contractlist" %}'; // هدایت به صفحه لیست قراردادها  
            }  
            return false; // جلوگیری از ارسال پیش‌فرض فرم  
        }  
    </script>
    
</body>
</html>